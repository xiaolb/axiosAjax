/**
 * util/ajax v0.0.1
 * (c) 2019 xiekaifeng4042
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("axios")):"function"==typeof define&&define.amd?define(["axios"],t):(e=e||self).topsAjax=t(e.axios)}(this,function(c){"use strict";c=c&&c.hasOwnProperty("default")?c.default:c;var e,s=(function(e){var t=function(a){var u,e=Object.prototype,s=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},o=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",n=t.toStringTag||"@@toStringTag";function i(e,t,r,n){var o=t&&t.prototype instanceof c?t:c,a=Object.create(o.prototype),i=new N(n||[]);return a._invoke=function(a,i,c){var u=f;return function(e,t){if(u===h)throw new Error("Generator is already running");if(u===p){if("throw"===e)throw t;return C()}for(c.method=e,c.arg=t;;){var r=c.delegate;if(r){var n=O(r,c);if(n){if(n===y)continue;return n}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(u===f)throw u=p,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);u=h;var o=l(a,i,c);if("normal"===o.type){if(u=c.done?p:d,o.arg===y)continue;return{value:o.arg,done:c.done}}"throw"===o.type&&(u=p,c.method="throw",c.arg=o.arg)}}}(e,r,i),a}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}a.wrap=i;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",y={};function c(){}function m(){}function v(){}var g={};g[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(E([])));w&&w!==e&&s.call(w,o)&&(g=w);var x=v.prototype=c.prototype=Object.create(g);function j(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(u){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,o){var a=l(u[e],u,r);if("throw"!==a.type){var i=a.arg,c=i.value;return c&&"object"==typeof c&&s.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):Promise.resolve(c).then(function(e){i.value=e,n(i)},function(e){return t("throw",e,n,o)})}o(a.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function O(e,t){var r=e.iterator[t.method];if(r===u){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=u,O(e,t),"throw"===t.method))return y;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,y;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=u),t.delegate=null,y):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,y)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function E(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(s.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=u,e.done=!0,e};return n.next=n}}return{next:C}}function C(){return{value:u,done:!0}}return m.prototype=x.constructor=v,v.constructor=m,v[n]=m.displayName="GeneratorFunction",a.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,n in e||(e[n]="GeneratorFunction")),e.prototype=Object.create(x),e},a.awrap=function(e){return{__await:e}},j(k.prototype),k.prototype[r]=function(){return this},a.AsyncIterator=k,a.async=function(e,t,r,n){var o=new k(i(e,t,r,n));return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},j(x),x[n]="Generator",x[o]=function(){return this},x.toString=function(){return"[object Generator]"},a.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=E,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&s.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=s.call(o,"catchLoc"),c=s.call(o,"finallyLoc");if(i&&c){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;P(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:E(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=u),y}},a}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(e={exports:{}},e.exports),e.exports);function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e){return(l="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":t(e)})(e)}function f(a,i,c,u){return new(c=c||Promise)(function(e,t){function r(e){try{o(u.next(e))}catch(e){t(e)}}function n(e){try{o(u.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new c(function(e){e(t.value)}).then(r,n)}o((u=u.apply(a,i||[])).next())})}function r(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r}function b(e,t){a.apply(e,j(t)?t:[t])}function w(e,t,r,n,o,a,i,c,u,s,l,f,d){var h=e;if("function"==typeof i?h=i(t,h):h instanceof Date?h=s(h):"comma"===r&&j(h)&&(h=h.join(",")),null===h){if(n)return a&&!f?a(t,k.encoder,d):t;h=""}if("string"==typeof h||"number"==typeof h||"boolean"==typeof h||x.isBuffer(h))return a?[l(f?t:a(t,k.encoder,d))+"="+l(a(h,k.encoder,d))]:[l(t)+"="+l(String(h))];var p,y=[];if(void 0===h)return y;if(j(i))p=i;else{var m=Object.keys(h);p=c?m.sort(c):m}for(var v=0;v<p.length;++v){var g=p[v];o&&null===h[g]||(j(h)?b(y,w(h[g],"function"==typeof r?r(t,g):t,r,n,o,a,i,c,u,s,l,f,d)):b(y,w(h[g],t+(u?"."+g:"["+g+"]"),r,n,o,a,i,c,u,s,l,f,d)))}return y}var u=Object.prototype.hasOwnProperty,d=Array.isArray,h=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),x={arrayToObject:r,assign:function(e,r){return Object.keys(r).reduce(function(e,t){return e[t]=r[t],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],i=Object.keys(a),c=0;c<i.length;++c){var u=i[c],s=a[u];"object"==typeof s&&null!==s&&-1===r.indexOf(s)&&(t.push({obj:a,prop:u}),r.push(s))}return function(e){for(;1<e.length;){var t=e.pop(),r=t.obj[t.prop];if(d(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n="string"==typeof e?e:String(e);if("iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var o="",a=0;a<n.length;++a){var i=n.charCodeAt(a);45===i||46===i||95===i||126===i||48<=i&&i<=57||65<=i&&i<=90||97<=i&&i<=122?o+=n.charAt(a):i<128?o+=h[i]:i<2048?o+=h[192|i>>6]+h[128|63&i]:i<55296||57344<=i?o+=h[224|i>>12]+h[128|i>>6&63]+h[128|63&i]:(a+=1,i=65536+((1023&i)<<10|1023&n.charCodeAt(a)),o+=h[240|i>>18]+h[128|i>>12&63]+h[128|i>>6&63]+h[128|63&i])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function n(o,a,i){if(!a)return o;if("object"!=typeof a){if(d(o))o.push(a);else{if(!o||"object"!=typeof o)return[o,a];(i&&(i.plainObjects||i.allowPrototypes)||!u.call(Object.prototype,a))&&(o[a]=!0)}return o}if(!o||"object"!=typeof o)return[o].concat(a);var e=o;return d(o)&&!d(a)&&(e=r(o,i)),d(o)&&d(a)?(a.forEach(function(e,t){if(u.call(o,t)){var r=o[t];r&&"object"==typeof r&&e&&"object"==typeof e?o[t]=n(r,e,i):o.push(e)}else o[t]=e}),o):Object.keys(a).reduce(function(e,t){var r=a[t];return u.call(e,t)?e[t]=n(e[t],r,i):e[t]=r,e},e)}},n=String.prototype.replace,o=/%20/g,p={default:"RFC3986",formatters:{RFC1738:function(e){return n.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"},y=Object.prototype.hasOwnProperty,m={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},j=Array.isArray,a=Array.prototype.push,i=Date.prototype.toISOString,k={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:x.encode,encodeValuesOnly:!1,formatter:p.formatters[p.default],indices:!1,serializeDate:function(e){return i.call(e)},skipNulls:!1,strictNullHandling:!1},v=(Object.prototype.hasOwnProperty,function(e,t){var r,n=e,o=function(e){if(!e)return k;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw new TypeError("Encoder has to be a function.");var t=e.charset||k.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=p.default;if(void 0!==e.format){if(!y.call(p.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var n=p.formatters[r],o=k.filter;return"function"!=typeof e.filter&&!j(e.filter)||(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:k.addQueryPrefix,allowDots:void 0===e.allowDots?k.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:k.charsetSentinel,delimiter:void 0===e.delimiter?k.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:k.encode,encoder:"function"==typeof e.encoder?e.encoder:k.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:k.encodeValuesOnly,filter:o,formatter:n,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:k.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:k.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:k.strictNullHandling}}(t);"function"==typeof o.filter?n=(0,o.filter)("",n):j(o.filter)&&(r=o.filter);var a,i=[];if("object"!=typeof n||null===n)return"";a=t&&t.arrayFormat in m?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var c=m[a];r=r||Object.keys(n),o.sort&&r.sort(o.sort);for(var u=0;u<r.length;++u){var s=r[u];o.skipNulls&&null===n[s]||b(i,w(n[s],s,c,o.strictNullHandling,o.skipNulls,o.encode?o.encoder:null,o.filter,o.sort,o.allowDots,o.serializeDate,o.formatter,o.encodeValuesOnly,o.charset))}var l=i.join(o.delimiter),f=!0===o.addQueryPrefix?"?":"";return o.charsetSentinel&&("iso-8859-1"===o.charset?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),0<l.length?f+l:""}),g=0;function O(e,t,r,n,o,a){return C(function(e,t){return e<<t|e>>>32-t}(C(C(t,e),C(n,a)),o),r)}function S(e,t,r,n,o,a,i){return O(t&r|~t&n,e,t,o,a,i)}function P(e,t,r,n,o,a,i){return O(t&n|r&~n,e,t,o,a,i)}function N(e,t,r,n,o,a,i){return O(t^r^n,e,t,o,a,i)}function E(e,t,r,n,o,a,i){return O(r^(t|~n),e,t,o,a,i)}function C(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}var L=function(e){return function(e){for(var t,r=g?"0123456789ABCDEF":"0123456789abcdef",n="",o=0;o<e.length;o++)t=e.charCodeAt(o),n+=r.charAt(t>>>4&15)+r.charAt(15&t);return n}(function(e){return function(e){for(var t="",r=0;r<32*e.length;r+=8)t+=String.fromCharCode(e[r>>5]>>>r%32&255);return t}(function(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var r=1732584193,n=-271733879,o=-1732584194,a=271733878,i=0;i<e.length;i+=16){var c=r,u=n,s=o,l=a;r=S(r,n,o,a,e[i+0],7,-680876936),a=S(a,r,n,o,e[i+1],12,-389564586),o=S(o,a,r,n,e[i+2],17,606105819),n=S(n,o,a,r,e[i+3],22,-1044525330),r=S(r,n,o,a,e[i+4],7,-176418897),a=S(a,r,n,o,e[i+5],12,1200080426),o=S(o,a,r,n,e[i+6],17,-1473231341),n=S(n,o,a,r,e[i+7],22,-45705983),r=S(r,n,o,a,e[i+8],7,1770035416),a=S(a,r,n,o,e[i+9],12,-1958414417),o=S(o,a,r,n,e[i+10],17,-42063),n=S(n,o,a,r,e[i+11],22,-1990404162),r=S(r,n,o,a,e[i+12],7,1804603682),a=S(a,r,n,o,e[i+13],12,-40341101),o=S(o,a,r,n,e[i+14],17,-1502002290),n=S(n,o,a,r,e[i+15],22,1236535329),r=P(r,n,o,a,e[i+1],5,-165796510),a=P(a,r,n,o,e[i+6],9,-1069501632),o=P(o,a,r,n,e[i+11],14,643717713),n=P(n,o,a,r,e[i+0],20,-373897302),r=P(r,n,o,a,e[i+5],5,-701558691),a=P(a,r,n,o,e[i+10],9,38016083),o=P(o,a,r,n,e[i+15],14,-660478335),n=P(n,o,a,r,e[i+4],20,-405537848),r=P(r,n,o,a,e[i+9],5,568446438),a=P(a,r,n,o,e[i+14],9,-1019803690),o=P(o,a,r,n,e[i+3],14,-187363961),n=P(n,o,a,r,e[i+8],20,1163531501),r=P(r,n,o,a,e[i+13],5,-1444681467),a=P(a,r,n,o,e[i+2],9,-51403784),o=P(o,a,r,n,e[i+7],14,1735328473),n=P(n,o,a,r,e[i+12],20,-1926607734),r=N(r,n,o,a,e[i+5],4,-378558),a=N(a,r,n,o,e[i+8],11,-2022574463),o=N(o,a,r,n,e[i+11],16,1839030562),n=N(n,o,a,r,e[i+14],23,-35309556),r=N(r,n,o,a,e[i+1],4,-1530992060),a=N(a,r,n,o,e[i+4],11,1272893353),o=N(o,a,r,n,e[i+7],16,-155497632),n=N(n,o,a,r,e[i+10],23,-1094730640),r=N(r,n,o,a,e[i+13],4,681279174),a=N(a,r,n,o,e[i+0],11,-358537222),o=N(o,a,r,n,e[i+3],16,-722521979),n=N(n,o,a,r,e[i+6],23,76029189),r=N(r,n,o,a,e[i+9],4,-640364487),a=N(a,r,n,o,e[i+12],11,-421815835),o=N(o,a,r,n,e[i+15],16,530742520),n=N(n,o,a,r,e[i+2],23,-995338651),r=E(r,n,o,a,e[i+0],6,-198630844),a=E(a,r,n,o,e[i+7],10,1126891415),o=E(o,a,r,n,e[i+14],15,-1416354905),n=E(n,o,a,r,e[i+5],21,-57434055),r=E(r,n,o,a,e[i+12],6,1700485571),a=E(a,r,n,o,e[i+3],10,-1894986606),o=E(o,a,r,n,e[i+10],15,-1051523),n=E(n,o,a,r,e[i+1],21,-2054922799),r=E(r,n,o,a,e[i+8],6,1873313359),a=E(a,r,n,o,e[i+15],10,-30611744),o=E(o,a,r,n,e[i+6],15,-1560198380),n=E(n,o,a,r,e[i+13],21,1309151649),r=E(r,n,o,a,e[i+4],6,-145523070),a=E(a,r,n,o,e[i+11],10,-1120210379),o=E(o,a,r,n,e[i+2],15,718787259),n=E(n,o,a,r,e[i+9],21,-343485551),r=C(r,c),n=C(n,u),o=C(o,s),a=C(a,l)}return Array(r,n,o,a)}(function(e){for(var t=Array(e.length>>2),r=0;r<t.length;r++)t[r]=0;for(r=0;r<8*e.length;r+=8)t[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return t}(e),8*e.length))}(function(e){var t,r,n="",o=-1;for(;++o<e.length;)t=e.charCodeAt(o),r=o+1<e.length?e.charCodeAt(o+1):0,55296<=t&&t<=56319&&56320<=r&&r<=57343&&(t=65536+((1023&t)<<10)+(1023&r),o++),t<=127?n+=String.fromCharCode(t):t<=2047?n+=String.fromCharCode(192|t>>>6&31,128|63&t):t<=65535?n+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):t<=2097151&&(n+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return n}(e)))};function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function T(t){return function(e){return{}.toString.call(e)==="[object ".concat(t,"]")}}function R(e){console.log(e)}function A(e){return L("".concat(e.method,"@").concat(e.baseURL).concat(e.url,"@ak=").concat(e.headers&&e.headers.Authorization||"","@params=").concat(e.params?JSON.stringify(e.params):"","@data=").concat(e.data?JSON.stringify(e.data):""))}function B(e,t){if(e===t)return!0;if("object"!=l(e)||null==e||"object"!=l(t)||null==t)return!1;if(Object.keys(e).length!=Object.keys(t).length)return!1;for(var r in e)if("ServerTime"!==r){if(!t.hasOwnProperty(r))return!1;if(!B(e[r],t[r]))return!1}return!0}var F=function(){function r(e){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.version=1,this.projectName="",this.storeName="ajax",this.db=null,this.isPending=!1,this.createDB(e).then(function(e){t.db=e})}return function(e,t,r){t&&D(e.prototype,t),r&&D(e,r)}(r,[{key:"createDB",value:function(e){e&&(this.projectName=e),e&&!this.storeName.includes(e)&&(this.storeName="".concat(this.storeName,"-").concat(e));var n=this;return new Promise(function(t){var r;n.isPending=!0,(r=n.db&&!n.db.objectStoreNames.contains(n.storeName)?(n.version++,n.db.close(),window.indexedDB.open("tops-ajax",n.version)):window.indexedDB.open("tops-ajax")).onerror=function(e){n.isPending=!1,console.error(e),t()},r.onsuccess=function(){n.isPending=!1,n.db=r.result,n.version=n.db.version,t(n.db)},r.onupgradeneeded=function(e){n.isPending=!1,console.log("onupgradeneeded"),e&&(n.db=r.result,n.db.objectStoreNames.contains(n.storeName)||n.db.createObjectStore(n.storeName,{keyPath:"requestmd5"})),t(n.db)}})}},{key:"checkdbStore",value:function(){return f(this,void 0,void 0,s.mark(function e(){return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isPending,this.db&&this.db.objectStoreNames.contains(this.storeName)){e.next=5;break}return e.next=4,this.createDB();case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e,this)}))}},{key:"getData4DB",value:function(o){return f(this,void 0,void 0,s.mark(function e(){var n=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkdbStore();case 2:return e.abrupt("return",new Promise(function(t){var r;try{var e=n.db.transaction([n.storeName]).objectStore(n.storeName);r=e.get(o)}catch(e){console.log(e),t(null),r=null}r&&(r.onerror=function(){console.log("\u4e8b\u52a1\u5931\u8d25"),t(null)},r.onsuccess=function(){r&&r.result?t(r.result.response):t()})}));case 3:case"end":return e.stop()}},e,this)}))}},{key:"addData4DB",value:function(c,u){return f(this,void 0,void 0,s.mark(function e(){var a,i=this;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkdbStore();case 2:if(this.db){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.getData4DB(c);case 6:return a=e.sent,e.abrupt("return",new Promise(function(e,t){var r,n;try{n=i.db.transaction([i.storeName],"readwrite").objectStore(i.storeName)}catch(e){t(e)}var o={requestmd5:c};o.response=u,(r=a?n.put(o):n.add(o)).onsuccess=function(){e()},r.onerror=function(e){t(e)}}));case 8:case"end":return e.stop()}},e,this)}))}}]),r}(),H=T("Undefined"),U=null,_={requests:{},save:function(e,t){this.requests[e]&&this.requests[e](),this.requests[e]=t},getKey:function(e){return L("".concat(e.method,"@").concat(e.baseURL).concat(e.url,"@ak=").concat(e.headers&&e.headers.Authorization||""))}},q={};return function(e){var t={showLoading:R,hideLoading:R,loginCallback:R,errorMsgHandler:R,requestConfig:{},projectName:"",beforeRequestHandler:function(t){return new Promise(function(e){e(t)})}},u=Object.assign({},t,e);U=new F(u.projectName);function r(e){var t,o=0<arguments.length&&void 0!==e?e:{url:"",method:"GET",loading:!1,isHandleError:!1};console.time("".concat(o.url,"-").concat(o.cache));var r=new c.CancelToken(function(e){t=e});window&&window.indexedDB||(o.cache=void 0),o.loading&&u.showLoading(o);var n=Object.assign({},u.requestConfig,{method:"GET",url:"",data:null,params:null,headers:{"Content-Type":"application/json; charset=UTF-8"},responseType:"json",withCredentials:!0,cancelToken:r}),a=o;for(var i in a)a.hasOwnProperty(i)&&T("Undefined")(a[i])&&delete a[i];return function e(t,r){if("object"!==l(r)||"object"!==l(t))Object.assign(t,r);else for(var n in r)r.hasOwnProperty(n)&&("object"===l(r[n])&&void 0!==t[n]&&null!==t[n]?e(t[n],r[n]):(t=t||{})[n]=void 0===r[n]?t[n]:r[n])}(n,o),_.save(_.getKey(n),t),u.beforeRequestHandler(n).then(function(n){return f(this,void 0,void 0,s.mark(function e(){var t,r;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T("Undefined")(o.cache)){e.next=18;break}if(!0===o.cache)return r=A(o),e.prev=3,q[r]=void 0,e.next=7,U.getData4DB(r);e.next=18;break;case 7:t=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),console.log(e.t0);case 13:if(!t||q[r])return e.abrupt("return",new Promise(function(){}));e.next=15;break;case 15:return q[r]=(new Date).getTime(),setTimeout(function(){Reflect.deleteProperty(q,r)},5e3),e.abrupt("return",Promise.resolve({data:t}));case 18:return e.abrupt("return",c(n));case 19:case"end":return e.stop()}},e,null,[[3,10]])}))},function(e){return e}).then(function(e){return function(i,c){return f(this,void 0,void 0,s.mark(function e(){var t,r,n,o,a;return s.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.timeEnd("".concat(c.url,"-").concat(c.cache)),u.hideLoading(c),!i.request||"blob"!==i.request.responseType){e.next=9;break}if(i.headers["content-disposition"])return e.abrupt("return",Promise.resolve(i));e.next=5;break;case 5:return(t=new FileReader).readAsText(i.data,"utf8"),t.onload=function(){return!this.result||"string"!=typeof this.result||c.isHandleError?Promise.reject(i.data||{}):this.result?u.errorMsgHandler(JSON.parse(this.result).Message):void 0},e.abrupt("return",!1);case 9:if(i){e.next=11;break}return e.abrupt("return");case 11:if(r=i.data,n=A(c),!H(r.Code)&&0!==r.Code){e.next=35;break}if(c.cache&&r.Data)try{U&&U.addData4DB(n,r)}catch(e){console.log(e)}if(!1!==c.cache){e.next=33;break}if(q[n])return e.prev=17,o=A(c),e.next=21,U.getData4DB(o);e.next=32;break;case 21:if((a=e.sent)&&B(r,a))return e.abrupt("return",new Promise(function(){}));e.next=24;break;case 24:r.Data&&U.addData4DB(o,r),e.next=30;break;case 27:e.prev=27,e.t0=e.catch(17),console.log(e.t0);case 30:e.next=33;break;case 32:q[n]=(new Date).getTime();case 33:return r.Data.cache=c.cache,e.abrupt("return",Promise.resolve(r.Data));case 35:if(c.isHandleError)return e.abrupt("return",Promise.reject(i.data||{}));e.next=37;break;case 37:if(i.data&&i.data.Message)return u.hideLoading(c),e.abrupt("return",Promise.resolve(null));e.next=40;break;case 40:if(302===r.Code)return window.location.href=r.message+window.location.hash,e.abrupt("return",Promise.resolve(null));e.next=43;break;case 43:if(4002===r.Code||4e3===r.Code)return u.loginCallback&&u.loginCallback instanceof Function&&u.loginCallback(r),e.abrupt("return",Promise.resolve(null));e.next=46;break;case 46:return e.abrupt("return",Promise.reject(c.isHandleError?i.data:{}));case 47:case"end":return e.stop()}},e,null,[[17,27]])}))}(e,n)},function(e){return function(e,t){u.hideLoading(t);var r=e.response||{data:null};return"Network Error"===e.message&&(e.message="\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01",r.data||(r.data={}),r.data.Message="\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\uff01"),t.isHandleError?(u.hideLoading(t),Promise.reject(r.data||{})):r.data&&r.data.Message?(setTimeout(function(){u.hideLoading(t),u.errorMsgHandler(r.data.Message)},0),Promise.resolve(null)):e.message?(setTimeout(function(){u.hideLoading(t),u.errorMsgHandler(e.message)},0),Promise.resolve(null)):Promise.reject(t.isHandleError&&r.data||{})}(e,n)})}return{getJSON:function(e){return e.method="GET",e.params&&Object.keys(e.params).length&&(e.paramsSerializer=function(e){return v(e,{indices:!1})}),r(e)},postJSON:function(e){return e.method="POST",e.params&&Object.keys(e.params).length&&(e.paramsSerializer=function(e){return v(e,{indices:!1})}),r(e)},putJSON:function(e){return e.method="PUT",r(e)},deleteJSON:function(e){return e.method="DELETE",r(e)},downloadFile:function(e,a){return window?(e.method="POST",e.responseType="blob",e.headers={"Content-Type":"blob"},r(e).then(function(e){if(e){var t="";try{t=decodeURIComponent(e.headers["content-disposition"].split("=")[1])}catch(e){console.log(e)}var r=e instanceof Blob?e:new Blob([e.data],{type:"application/octet-stream"}),n=window.URL.createObjectURL(r);if(null!==n){var o=document.createElement("a");o.style.display="none",document.body.appendChild(o),o.href=n,o.download=a&&a.fileName?a.fileName:t,o.click(),window.URL.revokeObjectURL(n)}}})):new Error("\u6b64\u65b9\u6cd5\u4f9d\u8d56\u6d4f\u89c8\u5668\u65b9\u6cd5 window.URL.createObjectURL")},postFormData:function(e){return e.method="POST",e.data=function(e){var t=[];for(var r in e){var n=encodeURIComponent(e[r]);t.push("".concat(r,"=").concat(n))}return t.join("&")}(e.data),e.headers={"Content-Type":"application/x-www-form-urlencoded"},r(e)}}}});